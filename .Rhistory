#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {browser()}
}
}
return(cm)
}
nbacor <- get.cor.and.cg.all(nba)
# Gives correlation matrices for fan dual
sal2.cms <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
sal2.get.cor <- function(x,nba.cor.cg) {
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {browser()}
}
}
return(cm)
}
nbacor <- get.cor.and.cg.all(nba)
# Gives correlation matrices for fan dual
sal2.cms <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
sal2.get.cor <- function(x,nba.cor.cg) {
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {
break
}
}
}
return(cm)
}
nbacor <- get.cor.and.cg.all(nba)
# Gives correlation matrices for fan dual
sal2.cms <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
source('C:/Users/cbe117/School/SportsAnalytics/NBA/nba_functions.R')
library(plyr)
nba <- convert.raw.nba("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\2015Season20160211.csv")
FD.nba.conversion <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FD.nba.conversion.csv")
sal <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FDSalaryNow_2_8_16.csv",stringsAsFactors=F)
res <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FDResults_2_8_16.csv",stringsAsFactors=F)
#fit.LM.2(nba,sal,res)
sal2a <- fit.LM.2.w.error(nba,sal,res)
sal2 <- sal2[-which(is.na(sal2a$PLAYER_ID)),]
sal2 <- sal2a[-which(is.na(sal2a$PLAYER_ID)),]
sal2.get.cor <- function(x,nba.cor.cg) {
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {
break
}
}
}
return(cm)
}
nbacor <- get.cor.and.cg.all(nba)
# Gives correlation matrices for fan dual
sal2.cms <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
library(MASS)
# DOESNT WORK, has 1 neg e-val, -.5, needs to be pos def
MASS::mvrnorm(1,rep(0,15),sal2.cms[[1]])
tmat <- sal2.cms[[1]]
eigen(tmat)$val
eigen(tmat+diag(.52,15))$val
tmat.cov <- tmat
tmat.cov.nms <- dimnames(tmat)[[1]]
for (i in 1:length(tmat.cov.nms)) {
tmat.cov[i,] <- tmat.cov[i,] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
tmat.cov[,i] <- tmat.cov[,i] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
}
eigen(tmat.cov)$val
MASS::mvrnorm(1,rep(0,15),tmat.cov)
length(sal2.cms)
source('C:/Users/cbe117/School/SportsAnalytics/NBA/nba_functions.R')
cor.to.cov <- function(tmat,sal2) {
tmat.cov <- tmat
tmat.cov.nms <- dimnames(tmat)[[1]]
for (i in 1:length(tmat.cov.nms)) {
tmat.cov[i,] <- tmat.cov[i,] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
tmat.cov[,i] <- tmat.cov[,i] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
}
return(tmat.cov)
}
cor.to.cov(tmat,sal2)
eigen(cor.to.cov(tmat,sal2))
all.covs <- lapply(sal2.cms,cor.to.cov)
all.covs <- lapply(sal2.cms,cor.to.cov,sal2)
str(all.covs)
source('C:/Users/cbe117/School/SportsAnalytics/NBA/nba_functions.R')
nbacor <- get.cor.and.cg.all(nba)
library(plyr)
nba <- convert.raw.nba("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\2015Season20160211.csv")
FD.nba.conversion <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FD.nba.conversion.csv")
sal <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FDSalaryNow_2_8_16.csv",stringsAsFactors=F)
res <- read.csv("C:\\Users\\cbe117\\School\\SportsAnalytics\\NBA\\FDResults_2_8_16.csv",stringsAsFactors=F)
sal2a <- fit.LM.2.w.error(nba,sal,res)
sal2 <- sal2a[-which(is.na(sal2a$PLAYER_ID)),]
nbacor <- get.cor.and.cg.all(nba)
str(nbacor)
length(nbacor)
length(nbacor[[1]])
nbacor[[1]]
sal2.get.cor <- function(x,nba.cor.cg) {
# Takes in a sal for a team along with nba.cor.cg
# and returns a correlation matrix for those players
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {
break
}
}
}
# Then create covariance matrix
tmat.cov <- cm
tmat.cov.nms <- dimnames(cm)[[1]]
for (i in 1:length(tmat.cov.nms)) {
tmat.cov[i,] <- tmat.cov[i,] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
tmat.cov[,i] <- tmat.cov[,i] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
}
return(list(cor=cm,cov=tmat.cov)
}
sal2.get.cor <- function(x,nba.cor.cg) {
# Takes in a sal for a team along with nba.cor.cg
# and returns a correlation matrix for those players
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {
break
}
}
}
# Then create covariance matrix
tmat.cov <- cm
tmat.cov.nms <- dimnames(cm)[[1]]
for (i in 1:length(tmat.cov.nms)) {
tmat.cov[i,] <- tmat.cov[i,] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
tmat.cov[,i] <- tmat.cov[,i] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
}
return(list(cor=cm,cov=tmat.cov))
}
sal2.cms <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
sal2.cms
length(sal2.cms)
sal2.cms[[1]]
sal2.cor.and.cov <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor)
View(sal2)
numeric(10)
numeric(10)->temp
temp
names(temp) <- 1:10
temp
source('C:/Users/cbe117/School/SportsAnalytics/NBA/nba_functions.R')
sal2.get.cor <- function(x,nba.cor.cg,sal2) {
# Takes in a sal for a team along with nba.cor.cg
# and returns a correlation matrix for those players
# Test: x <- sal2[sal2$Team=='ATL',]
TEAM_ID <- x$TEAM_ID[1]
#browser()
nms <- x$PLAYER_ID # Names of players on team
#cm <- diag(length(nms))
#matrix(0,length(nms),length(nms),dimnames = list(nms,nms)) # correlation matrix
#dimnames(cm) <- list(nms,nms)
nms.cor <- dimnames(nba.cor.cg[[as.character(TEAM_ID)]][[1]])[[1]]
min.games.played.together = 5
while(T) {
cm <- diag(length(nms))
dimnames(cm) <- list(nms,nms)
for(i in 1:(length(nms)-1)) {
for (j in (i+1):length(nms)) {
if(nms[i]%in%nms.cor  & nms[j]%in%nms.cor) {
if(nba.cor.cg[[as.character(TEAM_ID)]][[2]][as.character(nms[i]),as.character(nms[j])]>=min.games.played.together){
newval <- nba.cor.cg[[as.character(TEAM_ID)]][[1]][as.character(nms[i]),as.character(nms[j])]
cm[i,j] <- newval
cm[j,i] <- newval
}
}
}
}
if(min(eigen(cm)$val) >=0) {
break
} else {
print(c(min.games.played.together,min(eigen(cm)$val)))
min.games.played.together <- min.games.played.together + 5
if (min.games.played.together>50) {
break
}
}
}
# Then create covariance matrix
tmat.cov <- cm
tmat.cov.nms <- dimnames(cm)[[1]]
for (i in 1:length(tmat.cov.nms)) {
tmat.cov[i,] <- tmat.cov[i,] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
tmat.cov[,i] <- tmat.cov[,i] * sal2$LM.2.pred.se[sal2$PLAYER_ID==tmat.cov.nms[i]]
}
# Get predicted mean from sal2, column is LM.2.pred
means <- numeric(length(tmat.cov.nms))
names(means) <- tmat.cov.nms
for(i in 1:length(tmat.cov.nms)) {
nm.this <- as.character(tmat.cov.nms[i])
means[nm.this] <- sal2$LM.2.pred[as.character(sal2$PLAYER_ID)==nm.this]
}
return(list(mu=means,cor=cm,cov=tmat.cov))
}
sal2.cor.and.cov <- dlply(sal2,.(TEAM_ID),sal2.get.cor,nbacor,sal2)
sal2.cor.and.cov
length(sal2.cor.and.cov)
length(sal2.cor.and.cov[[1]])
sal2.cor.and.cov[[1]]
sal2.cor.and.cov[[1]]
sqrt(93.2379/500)
sqrt((93.2379-314*.00045723+314*1e-8)/500)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.01)},n0=10,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
setwd("C:/Users/cbe117/School/DOE/SMED/SMED-Code")
source('TestFunctions.R')
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.01)},n0=10,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/myfilledcontour.R')
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.01)},n0=10,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
my.filled.contour.func(banana,minmax=T)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/myfilledcontour.R')
my.filled.contour.func(banana,minmax=T)
my.filled.contour.func(banana,mainminmax=T)
my.filled.contour.func(banana,mainminmax=T)
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=T)
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=F)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/myfilledcontour.R')
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=F)
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=T)
signif(c(min(z),max(z)),3)
paste(signif(c(min(z),max(z)),3))
paste(signif(c(min(z),max(z)),3),collapse = '')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/myfilledcontour.R')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/myfilledcontour.R')
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=F)
my.filled.contour.func(function(x){exp(-(sum((x-.5)^2))/.01)},mainminmax=T)
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.01)},n0=40,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.1)},n0=40,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
SMED_GP_2D(f=function(x){exp(-(sum((x-.5)^2))/.1)},n0=40,n=5,contour.fit=1,GP.package='mlegp',continue.option=T)
SMED_GP_2D(f=banana,n0=50,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=50,n=5,contour.fit=1,GP.package='laGP',continue.option=T)
SMED_GP_2D(f=banana,n0=100,n=1,contour.fit=1,GP.package='laGP',continue.option=T)
SMED_GP_2D(f=banana,n0=200,n=1,contour.fit=1,GP.package='laGP',continue.option=T)
deleteGPsep(0)
deleteGPsep(1)
deleteGPsep(2)
deleteGPsep(3)
deleteGPsep(4)
deleteGPsep(5)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=200,n=1,contour.fit=1,GP.package='laGP',continue.option=T)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=200,n=1,contour.fit=1,GP.package='laGP',continue.option=T)
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T)
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
rgenoud::genoud(fn=function(xx){points(xx[1],xx[2],pch=19,cex=.1,col=3);log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))}
,nvars=2,max.generations=3,hard.generation.limit=T
,Domains=matrix(c(0,0,1,1),2,2,byrow=F),boundary.enforcement=T,pop.size=50
,print.level=0
)
opt.out
XX.LHS
XX.LHS[min.ind.LHS,]
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
opt.out
my.filled.contour.func(function(xx){log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))})
my.filled.contour.func(function(xx){log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))})
my.filled.contour.func(function(xx){log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))})
my.filled.contour.func(function(xx){log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))})
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
yy
(predict.GP.SMED(mod=mod,xx=xx))
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
opt.out
ttf <- function(xx){log(f_min(xx,X[keep.Delta,],kk=k,mod=mod))}
ttf(c(.5,.8))
ttf(c(.0,.835))
ttf(c(.0007,.835))
ttf(c(.0007,.835298))
ttf(c(0.0006897614, 0.8352983891))
min.ind.LHS
ttf(XX.LHS[931,])
log.f_min.LHS[931]
rainbow(100)
plot(1:100,rainbow(100))
plot(1:100,col=rainbow(100))
plot(1:100,col=rainbow(100,4))
plot(1:100,col=rainbow(100,.4))
plot(1:100,col=rainbow(100,.4),pch=19)
plot(1:100,col=rainbow(100,.4,.4),pch=19)
plot(1:100,col=rainbow(100,.4,.1),pch=19)
plot(1:100,col=rainbow(100,.4,.9),pch=19)
plot(1:100,col=rainbow(100,.4,.9,.2,.5),pch=19)
plot(1:100,col=rainbow(100,.4,.9),pch=19)
rgb(1,1,1)
plot(1:100,col=rgb(1:100,1,1),pch=19)
plot(1:100,col=rgb((1:100)/100,1,1),pch=19)
plot(1:100,col=rgb(1,(1:100)/100,1),pch=19)
plot(1:100,col=rgb(1,1,(1:100)/100),pch=19)
plot(1:100,col=rgb(1,1,(101:200)/100),pch=19)
plot(1:100,col=rgb(1,1,(1:100)/100),pch=19)
plot(1:100,col=rgb(1,1,(1:100)/200),pch=19)
plot(1:100,col=rgb(1,(1:100)/200,(1:100)/200),pch=19)
plot(1:100,col=rgb(1,(1:100)/100,(1:100)/100),pch=19)
plot(1:100,col=rgb(1,(1:100)/150,(1:100)/150),pch=19)
?round
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
rgb(1,(1:100)/150,(1:100)/150)[1+149*floor((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-log.f_min.LHS))]
summary(1+99*floor((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-log.f_min.LHS)))
summary(floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-log.f_min.LHS))))
summary(log.f_min.LHS)
summary((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-log.f_min.LHS))
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))]
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))/100,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))/300,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=(1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS)))))/300,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
my.filled.contour.func(function(xx)predict.GP.SMED(mod,xx))
text(x=X[,1],y=X[,2],col=ifelse(keep.Delta,'magenta','springgreen3'))
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=(1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS)))))/300,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=(1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))/100)/3,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
points(XX.LHS[,1],XX.LHS[,2],pch=19,cex=(1-floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))/100)/1,col=rgb(1,(1:100)/150,(1:100)/150)[floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS))))])
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
summary(log.f_min.LHS)
summary(floor(1+99*((log.f_min.LHS-min(log.f_min.LHS))/(max(log.f_min.LHS)-min(log.f_min.LHS)))))
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='GPfit',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='GPfit',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='mlegp',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='exact',continue.option=T,opt.method='LHS')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
source('C:/Users/cbe117/School/DOE/SMED/SMED-Code/SMED_GP_2D.R')
set.seed(0);SMED_GP_2D(f=banana,n0=30,n=1,contour.fit=1,GP.package='laGP',continue.option=T,opt.method='LHS')
